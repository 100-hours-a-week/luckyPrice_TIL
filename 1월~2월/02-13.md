 ![](https://velog.velcdn.com/images/luckyprice1103/post/33136299-73c6-44a5-854d-f4ab1a7a1347/image.png)
# GitLab ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì • ë°©ë²•1.
 ## 1. Gitlab ì„¤ì¹˜ ë° êµ¬ì„±.
 
 1. sudo mkdir -p /data/gitlab && cd /data/gitlab (GitLab ì„¤ì¹˜ ë””ë ‰í† ë¦¬ ìƒì„±)

```bash
sudo mkdir -p /data/gitlab && cd /data/gitlab
```

```bash
mkdir -p /data/gitlab
```
/data/gitlab ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±.
-p ì˜µì…˜: ë¶€ëª¨ ë””ë ‰í† ë¦¬(/data)ê°€ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ìƒì„±.
```bash
cd /data/gitlab
```
í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™.
âœ… ì¦‰, GitLab ë°ì´í„°ë¥¼ ì €ì¥í•  ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“¤ê³  ì´ë™í•˜ëŠ” ê³¼ì •.

2. sudo mkdir data logs config (GitLab ë°ì´í„° ë””ë ‰í† ë¦¬ êµ¬ì„±)

```bash
sudo mkdir data logs config
```

GitLabì€ ì—¬ëŸ¬ ê°œì˜ ë””ë ‰í† ë¦¬ë¥¼ í•„ìš”ë¡œ í•¨.
data/ â†’ Git ì €ì¥ì†Œ ë°ì´í„° ì €ì¥
logs/ â†’ GitLab ì‹¤í–‰ ë¡œê·¸ ì €ì¥
config/ â†’ GitLab ì„¤ì • íŒŒì¼ ì €ì¥
âœ… GitLabì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ë„ë¡ í•„ìš”í•œ ë””ë ‰í† ë¦¬ë¥¼ ë¯¸ë¦¬ ìƒì„±í•˜ëŠ” ë‹¨ê³„.

3. sudo chown -R $USER:$USER /data/gitlab (ë””ë ‰í† ë¦¬ ì†Œìœ ê¶Œ ë³€ê²½)
```bash
sudo chown -R $USER:$USER /data/gitlab
```
ì´ìœ 
```bash
chown -R $USER:$USER /data/gitlab
```
í˜„ì¬ ì‚¬ìš©ìê°€ /data/gitlab ë° í•˜ìœ„ ë””ë ‰í† ë¦¬ë¥¼ ì†Œìœ í•˜ë„ë¡ ë³€ê²½.
$USERëŠ” í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë¥¼ ì˜ë¯¸.
âœ… ë£¨íŠ¸(root) ê¶Œí•œ ì—†ì´ GitLabì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ëŠ” ê³¼ì •.

4. sudo chmod -R 755 /data/gitlab (ë””ë ‰í† ë¦¬ ì ‘ê·¼ ê¶Œí•œ ì„¤ì •)

```bash
sudo chmod -R 755 /data/gitlab
```
chmod -R 755
ì†Œìœ ì(ì½ê¸°, ì“°ê¸°, ì‹¤í–‰): rwx (7)
ê·¸ë£¹ & ë‹¤ë¥¸ ì‚¬ìš©ì(ì½ê¸°, ì‹¤í–‰ë§Œ ê°€ëŠ¥): r-x (5)
-R ì˜µì…˜ì€ ëª¨ë“  í•˜ìœ„ ë””ë ‰í† ë¦¬ì— ì ìš©.
âœ… GitLabì´ ì •ìƒì ìœ¼ë¡œ íŒŒì¼ì„ ì½ê³  ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ê¶Œí•œì„ ì„¤ì •í•˜ëŠ” ê³¼ì •.


> ğŸ’¡ ì´ ê³¼ì •ì´ í•„ìš”í•œ ì´ìœ 
GitLabì´ ë°ì´í„°ë¥¼ ì €ì¥í•  ë””ë ‰í† ë¦¬ë¥¼ í™•ë³´ (/data/gitlab + í•˜ìœ„ í´ë”)
GitLab ì‹¤í–‰ ì‹œ ê¶Œí•œ ë¬¸ì œë¥¼ ë°©ì§€ (chownìœ¼ë¡œ ì†Œìœ ê¶Œ ë³€ê²½)
í•„ìš”í•œ íŒŒì¼ ì ‘ê·¼ ê¶Œí•œì„ ì„¤ì • (chmod 755)


![](https://velog.velcdn.com/images/luckyprice1103/post/90100ac4-d046-4673-9520-5be911842f6e/image.png)

5. compse.yml íŒŒì¼ ì‘ì„±.
  GitLabì„ Docker Composeë¥¼ ì´ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¡œ ì‹¤í–‰í•˜ëŠ” ì„¤ì •
  
```bash
vi docker-compose.yml
```

```bash
 services:
 gitlab:
  image: yrzr/gitlab-ce-arm64v8:17.7.4-ce.0
  container_name: gitlab
  restart: always
  hostname: "192.168.0.31"
  environment:
   GITLAB_OMNIBUS_CONFIG: |
    external_url '192.168.0.31:80'
    gitlab_rails['gitlab_shell_ssh_port'] = 8022
   TZ: "Asia/Seoul"
  ports:
   - '80:80'
   - '443:443'
   - '8022:22'
  volumes:
   - './config:/etc/gitlab'
   - './logs:/var/log/gitlab'
   - './data:/var/opt/gitlab'
```


5. compse ì‹¤í–‰.
Docker Composeë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì˜ëœ ì—¬ëŸ¬ ê°œì˜ ì»¨í…Œì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰
```bash
docker-compose up -d
```

![](https://velog.velcdn.com/images/luckyprice1103/post/2ca9af88-d68f-4246-84d6-e431037ce1a1/image.png)





### GitLab Docker Compose ì‹¤í–‰ ìƒíƒœ í™•ì¸ ê°€ì´ë“œ ë¶„ì„


6. GitLab êµ¬ë™ ë¡œê·¸ í™•ì¸
ëª…ë ¹ì–´:
```bash
docker-compose logs -f
```
docker-composeë¥¼ ì‚¬ìš©í•˜ì—¬ GitLab ì»¨í…Œì´ë„ˆì˜ ë¡œê·¸ë¥¼ ì‹¤ì‹œê°„(-f)ìœ¼ë¡œ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´.
GitLabì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ê±°ë‚˜ ì˜¤ë¥˜ ë°œìƒ ì‹œ ì›ì¸ì„ íŒŒì•…í•˜ëŠ” ë° ìœ ìš©.


7. GitLab Pod ìƒíƒœ í™•ì¸
ëª…ë ¹ì–´:
```bash
docker-compose ps
```

![](https://velog.velcdn.com/images/luckyprice1103/post/6edadf6c-9a5d-4591-8778-642bb3abed72/image.png)


í˜„ì¬ docker-composeë¡œ ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ëª©ë¡ì„ ë³´ì—¬ì£¼ëŠ” ëª…ë ¹ì–´.
ì´ë¯¸ì§€ì˜ ì¶œë ¥ ë‚´ìš©ì„ ë³´ë©´:
ì»¨í…Œì´ë„ˆ ì´ë¦„: gitlab
ì‹¤í–‰ ìƒíƒœ: Up (healthy) â†’ GitLabì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ìˆìŒì„ ì˜ë¯¸
> í¬íŠ¸ ì •ë³´:
80 (HTTP)
443 (HTTPS)
22 (SSH) â†’ í˜¸ìŠ¤íŠ¸ì—ì„œëŠ” 8022 í¬íŠ¸ë¡œ ì ‘ê·¼ ê°€ëŠ¥
![](https://velog.velcdn.com/images/luckyprice1103/post/2ce0b6bc-75ba-4bde-bbbc-673a61f825b5/image.png)


8. GitLab ì´ˆê¸° íŒ¨ìŠ¤ì›Œë“œ í™•ì¸
ëª…ë ¹ì–´:
```bash
docker exec -it gitlab grep 'Password:' /etc/gitlab/initial_root_password
```
GitLabì˜ ì´ˆê¸° ë£¨íŠ¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´.
ì‹¤í–‰ ì‹œ:
> docker exec -it gitlab â†’ gitlab ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ëª…ë ¹ì–´ ì‹¤í–‰
grep 'Password:' /etc/gitlab/initial_root_password â†’ ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ê°€ ì €ì¥ëœ íŒŒì¼ì—ì„œ Password:ê°€ í¬í•¨ëœ ì¤„ ì¶œë ¥
GitLab ìµœì´ˆ ë¡œê·¸ì¸ ì‹œ root ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•  ë•Œ í•„ìˆ˜ì ìœ¼ë¡œ ì‚¬ìš©.



9. external_url ë¡œ ì„¤ì •í•œ ip or domain ë¸Œë¼ìš°ì € ì ‘ì† í›„ root/ initial password ì…ë ¥ í›„ ë¡œê·¸ì¸.
![](https://velog.velcdn.com/images/luckyprice1103/post/69a94151-cd7b-4e3e-a327-0cabb8bde54c/image.png)




### GitLab Runner

10. gitlab-runner í´ë” ìƒì„±, ê¶Œí•œ ë¶€ì—¬.
``` bash
sudo mkdir -p /data/gitlab-runner/config && cd /data/gitlab-runner
```
``` bash
sudo chown -R $USER:$USER /data/gitlab-runner
```


11. gitlab runner compose.yml ìƒì„±, ì‹¤í–‰.

```bash
version: '3.9'
services:
  gitlab-runner:
    image: gitlab/gitlab-runner:alpine3.19-bleeding
    platform: linux/arm64
    container_name: gitlab_runner
    restart: always
    volumes:
      - './config:/etc/gitlab-runner'
      - '/var/run/docker.sock:/var/run/docker.sock'

```
ì‹¤í–‰ì´ ì™„ë£Œ ë˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ ë¡œê·¸ê°€ ê³„ì† ë˜ëŠ”ë° gitlab ì—°ê²° ì„¤ì •ì´ ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì •ìƒ
![](https://velog.velcdn.com/images/luckyprice1103/post/79266222-c694-49ce-9483-810bcfdccf44/image.png)



12. Gitlabì— runnerë¥¼ ì—°ê²°í•˜ê¸° ìœ„í•´ registration tokenì„ í™•ì¸.


admin > runners > Registration token
![](https://velog.velcdn.com/images/luckyprice1103/post/a29ef87d-3380-41c1-90df-9c73aba897db/image.png)
ë‹¤ì‹œ ì½˜ì†”ë¡œ ëŒì•„ê°€ì„œ ì•ì„œ ì‹¤í–‰í–ˆë˜ runner ì»¨í…Œì´ë„ˆë¡œ ì ‘ì† 

```bash
docker exec -itu 0 gitlab-runner bash
```
registerë¥¼ í†µí•´ ë“±ë¡


![](https://velog.velcdn.com/images/luckyprice1103/post/03e0a21c-aa95-4660-9b59-7b4adf0e7afc/image.png)



![](https://velog.velcdn.com/images/luckyprice1103/post/785adf6a-e4f0-426e-8fc1-3845d82ebf2b/image.png)![](https://velog.velcdn.com/images/luckyprice1103/post/6f5d5f62-2de0-4c81-8b00-de04fbf37b93/image.png)
![](https://velog.velcdn.com/images/luckyprice1103/post/c062ec68-b4b2-4d55-a750-9c039676e7c3/image.png)



![](https://velog.velcdn.com/images/luckyprice1103/post/80810553-34aa-47e1-8718-0238712016ce/image.png)


![](https://velog.velcdn.com/images/luckyprice1103/post/daaa76b3-449a-464e-b04f-0282620eee06/image.png)







# GitLab ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì • ë°©ë²•2

## 1. í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
sudo apt-get update
sudo apt-get install -y curl openssh-server ca-certificates tzdata perl
```
- GitLab ì‹¤í–‰ì— í•„ìš”í•œ ê¸°ë³¸ íŒ¨í‚¤ì§€ ì„¤ì¹˜

### ì´ë©”ì¼ ì•Œë¦¼ì„ ìœ„í•œ Postfix ì„¤ì¹˜ (ì„ íƒ ì‚¬í•­)
```bash
sudo apt-get install -y postfix
```
- ì„¤ì¹˜ ì¤‘ `Internet Site` ì„ íƒ í›„ ê¸°ë³¸ ì„¤ì • ìœ ì§€
- ì™¸ë¶€ SMTP ì„œë²„ë¥¼ ì‚¬ìš©í•  ê²½ìš° ìƒëµ ê°€ëŠ¥

---

## 2. GitLab íŒ¨í‚¤ì§€ ì €ì¥ì†Œ ì¶”ê°€ ë° ì„¤ì¹˜
```bash
curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.deb.sh | sudo bash
```
```bash
sudo EXTERNAL_URL="https://gitlab.example.com" apt-get install gitlab-ee
```
- DNSê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
- HTTPSë¥¼ ì‚¬ìš©í•  ê²½ìš° Letâ€™s Encrypt ìë™ ì¸ì¦ì„œ ë°œê¸‰ë¨

### íŠ¹ì • ë²„ì „ ì„¤ì¹˜ ë° ì—…ë°ì´íŠ¸ ì œí•œ
```bash
apt-cache madison gitlab-ee  # ì„¤ì¹˜ ê°€ëŠ¥í•œ ë²„ì „ í™•ì¸
sudo apt-mark hold gitlab-ee  # ìë™ ì—…ë°ì´íŠ¸ ì œí•œ
sudo apt-mark showhold  # ì œí•œëœ íŒ¨í‚¤ì§€ í™•ì¸
```

---

## 3. GitLab ì›¹ ì¸í„°í˜ì´ìŠ¤ ì ‘ì† ë° ë¡œê·¸ì¸
- ë¸Œë¼ìš°ì €ì—ì„œ `https://gitlab.example.com` ì ‘ì†
- ê¸°ë³¸ ê´€ë¦¬ì ê³„ì •: `root`
- ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ í™•ì¸: `/etc/gitlab/initial_root_password` (ì„¤ì¹˜ í›„ 24ì‹œê°„ ë‚´ì— í™•ì¸ ê°€ëŠ¥)

---

## 4. ì´ë©”ì¼ êµ¬ë… ì„¤ì • (ì„ íƒ ì‚¬í•­)
- ë³´ì•ˆ ì—…ë°ì´íŠ¸ ë° GitLab ê´€ë ¨ ì†Œì‹ ìˆ˜ì‹  ì—¬ë¶€ ì„¤ì • ê°€ëŠ¥

---

## 5. ì¶”ì²œ í›„ì† ì‘ì—…
- ì¸ì¦ ì˜µì…˜ ë° ì‚¬ìš©ì ê°€ì… ì œí•œ ì„¤ì •
- ì¶”ê°€ì ì¸ ë³´ì•ˆ ë° ì„±ëŠ¥ ìµœì í™” ì‘ì—… ê³ ë ¤



