ëª©ì°¨
> 1. ë„ì»¤ì˜ ì—­ì‚¬
2. ê¸°ìˆ ì  Overview
3. ë„ì»¤ ì„¤ì¹˜ì™€ ì‹¤í–‰
4. ì„œë“œ íŒŒí‹° ì»¨í…Œì´ë„ˆ ì‚¬ìš©
5. Demo ì–´í”Œë¦¬ì¼€ì´ì…˜
6. ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë§Œë“¤ê¸°
7. ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬
8. ì»¨í…Œì´ë„ˆ ëŒë¦¬ê¸°
9. ì»¨í…Œì´ë„ˆ ë³´ì•ˆ
10. ë„ì»¤ ê°ì²´ì™€ ìƒí˜¸ì‘ìš©
11. workflow ê°œë°œ
12. ì»¨í…Œì´ë„ˆ ë°°í¬

## 1. ë„ì»¤ì˜ ì—­ì‚¬

![](https://velog.velcdn.com/images/luckyprice1103/post/50548703-f091-411c-9347-3869cd52239e/image.png)

ì™œ ì»¨í…Œì´ë„ˆê°€ ë§Œë“¤ì–´ì¡Œê³ , ì™œ ë„ì»¤ëŠ” ì„±ê³µí–ˆì„ê¹Œ?

> ë„ì»¤ëŠ” ê°œë°œìì˜ í™˜ê²½ê³¼ ì‚¬ìš©ìì˜ í™˜ê²½ì„ ìµœëŒ€í•œ ê°€ê¹ê²Œ ë§Œë“¤ì–´ì¤€ë‹¤.

- ê°œë°œ
 
 ì—­ì‚¬ì ìœ¼ë¡œ ê°œë°œìì˜ í™˜ê²½ì€ ë³µì¡í•œ í”„ë¡œì œìŠ¤ë¥¼ í¬í•¨ì‹œí‚¨ë‹¤. ë„ì»¤ëŠ” ì´ê²ƒì„ ê°œë°œìì—ê²Œ ë‹¨ìˆœ ëª…ë ¹, ë„ì»¤ compsed up, ê·¸ë¦¬ê³  ìœˆë„ìš°, ë§¥, ë¦¬ëˆ…ìŠ¤ì—ì„œ ì–‘ë¦½ ê°€ëŠ¥í•˜ë„ë¡ í—ˆìš©í•˜ë©´ì„œ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ì¤€ë‹¤.
 ![](https://velog.velcdn.com/images/luckyprice1103/post/e0a197f3-5db0-43bc-a994-87c31edf11e7/image.png)
 
 - ë°°í¬
 
 
ë°°í¬ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì£¼ë¡œ ëª‡ê°€ì§€ì˜ ì ˆì°¨ë¥¼ í¬í•¨í•´ì™”ë‹¤. ì„œë²„ë¥¼ ë§Œë“¤ê³  dependencyë¥¼ ì„¤ì •í•œë‹¤ìŒ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œë¥¼ ë³µì‚¬í–ˆë‹¤. ì½˜í…Œì´ë„ˆëŠ” ë‹¨ìˆœ í‘œì¤€ íŒ¨í‚¤ì§€ë¥¼ ì†Œê°œí–ˆê³ , ë‹¨ìˆœíˆ í•„ìš”í•œ ì»¨í…Œì´ë„ˆì™€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë§Œ ê°€ì§€ê³  ë°°í¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.
![](https://velog.velcdn.com/images/luckyprice1103/post/649428d6-da73-4fc7-b551-8ae9b1240313/image.png)

> ì»¨í…Œì´ë„ˆë€?

ë„ì»¤ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë€ ê°€ë³ê³ , ë…ë¦½ì ì¸ ì†Œí”„íŠ¸ì›¨ì–´ ì‹¤í–‰íŒ¨í‚¤ì§€ì´ë‹¤. ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•œ ëª¨ë“  í•„ìš”í•œê²ƒì„ í¬í•¨í•˜ê³  ìˆë‹¤.

- Underlying OS dependencies
- Runtime dependencies (e.g., Python runtime)
- Libraries (e.g., SQL Alchemy, FastAPI)
- Application code
![](https://velog.velcdn.com/images/luckyprice1103/post/c78ecb03-dc56-41e6-827a-3bddd01af24d/image.png)

> ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì™€ ì»¨í…Œì´ë„ˆì˜ ì°¨ì´ì ì€ ê°ì²´ì§€í–¥í˜• í”„ë¡œê·¸ë¨ì—ì„œ í´ë˜ìŠ¤ì™€ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¨ì´ ë¼ê³  ìƒê°í•˜ë©´ ì‰½ë‹¤.
- ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ - class
- ì»¨í…Œì´ë„ˆ - instance

&nbsp
> Open Container Initiative (OCI)

OCIëŠ” ì»¨í…Œì´ë„ˆ í¬ë©§ì— ëŒ€í•œ í‘œì¤€ì„ ë§Œë“¤ê¸° ìœ„í•´ ë§Œë“  ì—…ê³„ì˜ í˜‘ë ¥ì´ë‹¤. Docker, Google, VMware, Microsoft, Dell, IBM, and Oracle ê°™ì€ íšŒì‚¬ë“¤ë¡œë¶€í„° ì„¤ë¦½ë˜ì—ˆë‹¤. OCIëŠ” ì„¸ê°€ì§€ ì£¼ìš”í•œ ìŠ¤í™ì„ ì •ì˜í•œë‹¤.

- ì´ë¯¸ì§€ Specification: ì´ë¯¸ì§€ì˜ ë©”íƒ€ë°ì´í„°ì™€, ì§ë ¬ íŒŒì¼ ì‹œìŠ¤í…œì„ í¬í•¨í•œ í¬ë©§ì„ ì •ì˜í•œë‹¤.

- ëŸ°íƒ€ì„ Specification: ì´ë¯¸ì§€ ì‚¬ì–‘ì„ ì¤€ìˆ˜í•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•œë‹¤.

- ë¶„ë°° Specification: ì´ë¯¸ì§€ê°€ ì–´ë–»ê²Œ ë¶„ë°°ë˜ì–´ì•¼ í•˜ëŠ”ê°€ì— ëŒ€í•œ ê°œìš”, ì˜ˆë¥¼ ë“¤ì–´ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ í†µí•´ ì´ë¯¸ì§€ë¥¼ í‘¸ì‹œí•˜ê³  ê°€ì ¸ì˜¤ëŠ” ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.

![](https://velog.velcdn.com/images/luckyprice1103/post/1f1632fa-8e63-4e99-a04c-551c8cebd838/image.png)

&nbsp
> ê°€ìƒí™”ì˜ ë°œì „

- Bare Metal

ê°€ìƒí™”ê°€ ë°œëª…ë˜ê¸° ì „ì—ëŠ” ëª¨ë“  í”„ë¡œê·¸ë¨ì´ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì—ì„œ ì§ì ‘ ì‹¤í–‰ë˜ì—ˆë‹¤. ì‚¬ëŒë“¤ì€ ì´ê²ƒì„ ë² ì–´ë©”íƒˆ(Bare Metal)ì´ë¼ê³  ë¶€ë¥´ëŠ”ë°, ë² ì–´ ë©”íƒˆì—ì„œ ì‹¤í–‰í•˜ëŠ” ê²ƒì€ ìš°ë¦¬ê°€ ë©í†±/ë°ìŠ¤í¬íƒ‘ ì»´í“¨í„°ì— í”„ë¡œê·¸ë¨ì„ ì„¤ì¹˜í•  ë•Œë§ˆë‹¤ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ì´ë‹¤.
![](https://velog.velcdn.com/images/luckyprice1103/post/d373d982-c6ca-4707-9ecc-fdc32eba8866/image.png)


- Virtual Machines
![](https://velog.velcdn.com/images/luckyprice1103/post/0bd44012-3bad-4066-920e-282b30697b28/image.png)


ê°€ìƒ ë¨¸ì‹ ì€ í˜¸ìŠ¤íŠ¸ ë¦¬ì†ŒìŠ¤ë¥¼ ì—¬ëŸ¬ ê°œì˜ ê²©ë¦¬ëœ ê°€ìƒ í•˜ë“œì›¨ì–´ êµ¬ì„±ìœ¼ë¡œ ë¶„í• í•  ìˆ˜ ìˆëŠ” "í•˜ì´í¼ë°”ì´ì €"ë¼ëŠ” ì‹œìŠ¤í…œì„ ì‚¬ìš©í•œë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì´ë¥¼ ìì²´ ì‹œìŠ¤í…œ(ê°ê° OS, ë°”ì´ë„ˆë¦¬/ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ í¬í•¨)ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
![](https://velog.velcdn.com/images/luckyprice1103/post/0e66b480-2352-4ea6-82e4-825919d4ff30/image.png)


- Containers

ì»¨í…Œì´ë„ˆëŠ” ë°”ì´ë„ˆë¦¬/ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ë° êµ¬ì„±ì„ ìœ„í•œ ê²©ë¦¬ëœ í™˜ê²½ì„ ì œê³µí•œë‹¤ëŠ” ì ì—ì„œ ê°€ìƒ ë¨¸ì‹ ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ, í•˜ë“œì›¨ì–´ ê³„ì¸µ ì»¨í…Œì´ë„ˆì—ì„œ ê°€ìƒí™”í•˜ëŠ” ëŒ€ì‹  ê¸°ë³¸ Linux ê¸°ëŠ¥(cgroups + ë„¤ì„ìŠ¤í˜ì´ìŠ¤)ì„ ì‚¬ìš©í•˜ì—¬ ë™ì¼í•œ ì»¤ë„ì„ ê³µìœ í•˜ë©´ì„œ ê²©ë¦¬ë¥¼ ì œê³µí•œë‹¤.
![](https://velog.velcdn.com/images/luckyprice1103/post/fad1375b-b6a2-46a3-afa1-c7e5bb60a645/image.png)


## 2. ê¸°ìˆ ì˜ ê°œìš”

> Linux Building Blocks

ì»¨í…Œì´ë„ˆëŠ” ì„¸ ê°€ì§€ Linux ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ ê¸°ëŠ¥ì„ ë°œíœ˜í•œë‹¤.

- ë„¤ì„ìŠ¤í˜ì´ìŠ¤  
ë„¤ì„ìŠ¤í˜ì´ìŠ¤ëŠ” ì „ì—­ ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ë¥¼ ì¶”ìƒí™”ë¡œ ë˜í•‘í•˜ì—¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ì˜ í”„ë¡œì„¸ìŠ¤ì— ì „ì—­ ë¦¬ì†ŒìŠ¤ì˜ ê²©ë¦¬ëœ ì¸ìŠ¤í„´ìŠ¤ê°€ ìˆëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•œë‹¤.
ì „ì—­ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ë³€ê²½ ì‚¬í•­ì€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ êµ¬ì„±ì›ì¸ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— í‘œì‹œë˜ì§€ë§Œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì—ëŠ” í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤.
ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì€ ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ë³´ì´ì§€ ì•Šê²Œ ìœ ì§€í•˜ê±°ë‚˜ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ ì‚¬ìš©ìë¥¼ í˜¸ìŠ¤íŠ¸ì˜ ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.

- cgroup
Cgroupì€ í”„ë¡œì„¸ìŠ¤ë¥¼ ê³„ì¸µì  ê·¸ë£¹ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ë‹¤ì–‘í•œ ìœ í˜•ì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ì„ ì œí•œí•˜ê³  ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆëŠ” Linux ì»¤ë„ ê¸°ëŠ¥ì´ë‹¤
cgroupì„ ì‚¬ìš©í•˜ë©´ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì€ ì»¨í…Œì´ë„ˆê°€ ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
  - CPU ì£¼ê¸°(cpu.shares)ì˜ ìµœëŒ€ XX%ë¥¼ ì‚¬ìš©í•œë‹¤.
  - ìµœëŒ€ YYMB ë©”ëª¨ë¦¬ ì‚¬ìš©(memory.limit_in_bytes)
  - ìŠ¤ë¡œí‹€ì€ ZZMB/sê¹Œì§€ ì½ëŠ”ë‹¤.(bkio.throttle.read_bps_device).
  
- ìœ ë‹ˆì˜¨ íŒŒì¼ ì‹œìŠ¤í…œ
í†µí•© íŒŒì¼ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ë©´ ë¶„ê¸°ë¼ê³  ì•Œë ¤ì§„ ë³„ë„ì˜ íŒŒì¼ ì‹œìŠ¤í…œì˜ íŒŒì¼ê³¼ ë””ë ‰í„°ë¦¬ë¥¼ íˆ¬ëª…í•˜ê²Œ ì˜¤ë²„ë ˆì´í•˜ì—¬ ì¼ê´€ëœ ë‹¨ì¼ íŒŒì¼ ì‹œìŠ¤í…œì„ í˜•ì„±í•  ìˆ˜ ìˆë‹¤.
ë³‘í•©ëœ ë¶„ê¸° ë‚´ì—ì„œ ë™ì¼í•œ ê²½ë¡œë¥¼ ê°–ëŠ” ë””ë ‰í„°ë¦¬ì˜ ë‚´ìš©ì€ ìƒˆë¡œìš´ ê°€ìƒ íŒŒì¼ ì‹œìŠ¤í…œ ë‚´ì˜ ë‹¨ì¼ ë³‘í•© ë””ë ‰í„°ë¦¬ì— í•¨ê»˜ í‘œì‹œëœë‹¤.
ì´ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ê³µí†µ ë ˆì´ì–´ë¥¼ ê³µìœ í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´, ë™ì¼í•œ ì´ë¯¸ì§€ì˜ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆê°€ ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ì— ìƒì„±ëœ ê²½ìš° ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì€ ê° ì»¨í…Œì´ë„ˆì— íŠ¹ì •í•œ ì”¬ ì˜¤ë²„ë ˆì´ë§Œ í• ë‹¹í•˜ë©´ ë˜ë©° ê¸°ë³¸ ì´ë¯¸ì§€ ë ˆì´ì–´ëŠ” ê³µìœ ë  ìˆ˜ ìˆë‹¤.
ê°ê° ë¦¬ì†ŒìŠ¤ ì œì•½ ì¡°ê±´ê³¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ê²©ë¦¬ë¥¼ ì œê³µí•˜ëŠ” Cgroup ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤. ë˜í•œ ê³µí†µ ë ˆì´ì–´ì— ì´ë¯¸ì§€ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆëŠ” í†µí•© íŒŒì¼ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ êµ¬ì¶•í•˜ê³  ê³µìœ í•  ìˆ˜ ìˆë‹¤.

![](https://velog.velcdn.com/images/luckyprice1103/post/cbdac7ea-c773-41fa-9e2a-da831dfa9afb/image.png)


> Docker Desktop Architecture

![](https://velog.velcdn.com/images/luckyprice1103/post/d74ca9fe-7904-486d-9acf-48ca4bb63c59/image.png)

- A client application
  - command Line Interface (CLI)
  - Graphical User Interface (GUI)
  - Credential Helper : ê°œì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ëŒ€í•œ ìê²© ì¦ëª…ì„ ì €ì¥
  - Extensions : ì¶”ê°€ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì™¸ë¶€ ì†Œí”„íŠ¸ì›¨ì–´

- A Linux virtual machine containing
  - Docker daemon (dockerd): ì„œë²„ í˜¸ìŠ¤íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì˜ ì»¨í…Œì´ë„ˆ ê°œì²´, ë„¤íŠ¸ì›Œí‚¹ ë° ë³¼ë¥¨ ê´€ë¦¬. í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ì˜ í†µì‹ ì„ ìœ„í•´ Docker APIë¥¼ ë…¸ì¶œí•¨..
  - (ì„ íƒ) Kubernetes cluster
  
- Registries
  - ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” Docker ìì²´ì˜ ì¼ë¶€ëŠ” ì•„ë‹ˆì§€ë§Œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ê³  ê³µìœ í•˜ëŠ” ê¸°ë³¸ ë©”ì»¤ë‹ˆì¦˜....! DockerëŠ” DockerHubë¼ëŠ” ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ì‹¤í–‰í•˜ì§€ë§Œ ë‹¤ë¥¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë„ ë§ì´ ìˆìŒ.
  
  
## 3. ë„ì»¤ì˜ ì„¤ì¹˜ì™€ ì‹¤í–‰
  
  [ë„ì»¤ ì„¤ì¹˜ í•˜ê¸°](https://www.docker.com/)
  
  ì„¤ì¹˜ë¥¼ ì™„ë£Œí•˜ë©´ ì´ì œ ê°„ë‹¨í•œ ì»¨í…Œì´ë„ˆë¥¼ êµ¬ë™í•´ë³´ì.
  
  ```
docker run --env POSTGRES_PASSWORD=ansadmin --publish 5432:5432 postgres:15.7-alpine
```
![](https://velog.velcdn.com/images/luckyprice1103/post/d1c0ee29-d2d4-415c-bc10-48a26e237ca0/image.png)![](https://velog.velcdn.com/images/luckyprice1103/post/c6abf995-e33a-4aa2-b09c-0f26adcef7b2/image.png)
ì»¨í…Œì´ë„ˆ ì‘ë™ì´ ì˜ ëœë‹¤....!
![](https://velog.velcdn.com/images/luckyprice1103/post/cc201512-d8c5-45ea-8a13-4d4f5c16c6a6/image.png)pgAdmin4 ì„œë²„ connectionì—ì„œë„ ì—°ê²°ì´ ëœë‹¤...!

## 4. ì„œë“œíŒŒí‹° ì»¨í…Œì´ë„ˆ ì‚¬ìš©

![](https://velog.velcdn.com/images/luckyprice1103/post/6da25a1c-a227-4393-807b-46c57a991567/image.png)

> ë°ì´í„°ì˜ ì§€ì†ì„±

![](https://velog.velcdn.com/images/luckyprice1103/post/1a254cc4-c5e8-4179-8b28-14d68aee2cee/image.png)


ìš°ë¦¬ê°€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¡œ ë¶€í„° ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ë–„, ì´ë¯¸ì§€ì— ìˆëŠ” ëª¨ë“ ê²ƒì€ read-onlyë¡œ ì·¨ê¸‰ëœë‹¤. ê·¸ë¦¬ê³  ë§¨ìœ„ì— ìƒˆë¡œìš´ layerê°€ read/wirteë¡œ ì’¸ì›Œì§„ë‹¤.


> dependency ì„¤ì¹˜ ë°ì´í„° ë³´ì¡´


ì´ì œ ì»¨í…Œì´ë„ˆê°€ runtimeí• ë•Œ ë¬´ì–¸ê°€ë¥¼ ì„¤ì¹˜í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì‹¤ìŠµì„ í•´ë³´ì. ë¬¼ë¡  ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë ë•Œ contentë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒì€ ì£¼ëœ í–‰ë™ì€ ì•„ë‹ˆì§€ë§Œ í•™ìŠµ ëª©ì ìœ¼ë¡œ í•´ë³´ì


```
# ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ë¡œë¶€í„° ì»¨íƒœì´ë„ˆ ë§Œë“¤ê¸°
docker run --interactive --tty --rm ubuntu:22.04
```

-it (ë˜ëŠ” --interactiveì™€ --tty): ì»¨í…Œì´ë„ˆì™€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ëŒ€í™”í˜• ëª¨ë“œë¡œ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ í„°ë¯¸ë„ì— ì ‘ì†í• ìˆ˜ ìˆìŒ. ì´ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê³  í„°ë¯¸ë„ ì„¸ì…˜ì„ ìœ ì§€ê°€ëŠ¥í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

 --rm ì˜µì…˜ì€ ì»¨í…Œì´ë„ˆë¥¼ ì¼íšŒì„±ìœ¼ë¡œ ì‹¤í–‰í•  ë•Œ ì£¼ë¡œ ì“°ì´ëŠ”ë° ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ ì»¨í…Œì´ë„ˆì™€ ê´€ë ¨ëœ ë¦¬ì†ŒìŠ¤(íŒŒì¼ ì‹œìŠ¤í…œ, ë³¼ë¥¨)ê¹Œì§€ ê¹¨ë—ì´ ì œê±°í•´ì¤€ë‹¤.
 
 
 ```
# ping ì„¤ì¹˜
apt update
apt install iputils-ping --yes
```

 ```
 # google.comdì— ping ì‹œë„
ping google.com -c 1
```
![](https://velog.velcdn.com/images/luckyprice1103/post/8ed49fc5-f9c5-4d64-b523-84ad42f707bd/image.png)


ì´ì œ ë‹¤ì‹œ ì‹œë„ í•´ë³´ì.
```
docker run --interactive --tty --rm ubuntu:22.04
ping google.com -c 1
```

ìœ„ì— ì½”ë“œê°€ ë ì§€ ì•ˆë ì§€ ë°ì´í„°ì˜ ì§€ì†ì„±ì— ëŒ€í•´ ìƒê°í•˜ë©´ì„œ ì¶”ì¸¡í•´ë³´ì.
.
.
.
.
.
.
.
.
.
ë‹µì€ ë‹¹ì—°íˆ ì‹¤í–‰ì´ ì•ˆëœë‹¤. ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ëŠ” ìˆœê°„ ì›ë˜ ìˆëŠ” ë°ì´í„°ëŠ” ëª¨ì¡°ë¦¬ ë‚ ë¼ê°„ë‹¤. ê·¸ë ‡ë‹¤ë©´ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²° í•  ìˆ˜ ìˆì„ê¹Œ?


```
# ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ë¡œë¶€í„° ì»¨í…Œì´ë„ˆ ìƒì„± (--rm flag ì—†ì´)
docker run -it --name my-ubuntu-container ubuntu:22.04
```
í•‘ì„ ì„¤ì¹˜í•˜ê³  ë‹¤ì‹œ exit í•´ë³´ì
```
# Install & use ping
apt update
apt install iputils-ping --yes
ping google.com -c 1
exit
```

![](https://velog.velcdn.com/images/luckyprice1103/post/56480008-8eb1-434f-bed6-fa3b4fac0897/image.png)
docker ps -aë¥¼ í†µí•´í™•ì¸í•´ë³´ë‹ˆ ì»¨í…Œì´ë„ˆëŠ” stopped ë˜ê¸´ í–ˆì§€ë§Œ, ì•„ì§ read/write ì˜ì—­ì— ì¡´ì¬í•˜ê³  ìˆëŠ”ê²ƒìœ¼ ì•Œ ìˆ˜ ìˆë‹¤. ë‹¤ì‹œ ì»¨í…Œì´ë„ˆë¥¼ ì‹œì‘í•´ì„œ pingëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ë³´ì

```
# Restart the container and attach to running shell
docker start my-ubuntu-container
docker attach my-ubuntu-container
```

```
# Test ping
ping google.com -c 1 # ì„±ê³µ! ğŸ‰
exit
```

ê·¼ë° ì‚¬ì‹¤ ìš°ë¦¬ê°€ ì›í•˜ëŠ”ê±´ ì´ëŸ°ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì•„ì˜ˆ ì²˜ìŒë¶€í„° ì´ë¯¸ì§€ ìì²´ì— ë°ì´í„°ë“¤ì´ í¬í•¨ë˜ëŠ” ê²ƒì„ ì›í•œë‹¤. ì¦‰ ìš°ë¦¬ëŠ” dependencyê°€ í¬í•¨ëœ ìš°ë¦¬ë§Œì˜ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ì•¼í•œë‹¤.

```
# Build a container image with ubuntu image as base and ping installed
docker build --tag my-ubuntu-image -<<EOF
FROM ubuntu:22.04
RUN apt update && apt install iputils-ping --yes
EOF

# Run a container based on that image
docker run -it --rm my-ubuntu-image

# Confirm that ping was pre-installed
ping google.com -c 1 # Success! ğŸ¥³
```

> ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìƒì„±ëœ ì§€ì† ë°ì´í„°

![](https://velog.velcdn.com/images/luckyprice1103/post/73cd7d62-88e2-4e91-825a-b1a7c562fafc/image.png)

ì´ë²ˆì—ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í•´ ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ëŠ” ì‹¤ìŠµì„ í•´ë³´ì.

```
# ì½˜í…Œì´ë„ˆ ìƒì„±
docker run -it --rm ubuntu:22.04

# ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“œê³  íŒŒì¼ì„ ê·¸ ì•ˆì— ì €ì¥
mkdir my-data
echo "Hello from the container!" > /my-data/hello.txt

# íŒŒì¼ í™•ì¸
cat my-data/hello.txt
exit
```
![](https://velog.velcdn.com/images/luckyprice1103/post/319f3ecf-3cb6-4e51-9d37-8c05d44e5b91/image.png)


```
# ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ë¡œ ë¶€í„° ì½˜í…Œì´ë„ˆ ìƒì„±
docker run -it --rm ubuntu:22.04

# íŒŒì¼ì´ ì•„ì§ ë‚¨ì•„ìˆëŠ”ì§€ í™•ì¸
cat my-data/hello.txt # Produces error: `cat: my-data/hello.txt: No such file or directory`
```

![](https://velog.velcdn.com/images/luckyprice1103/post/46a3b150-65ac-4bbb-984e-8f84a1c77f4c/image.png)

ì§ì‘í–ˆë“¯ì´, ìƒˆ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“œëŠ” ìˆœê°„ ë°ì´í„°ê°€ ì‹¹ ë‚ ì•„ê°„ë‹¤
ì´ë¥¼ ë°©ì§€ í•˜ê¸° ìœ„í•´ì„œ volumeì„ ì´ìš©í•´ë³´ì.

> - ë³¼ë¥¨ ë§ˆìš´íŠ¸

```
# ì´ë¦„ì„ ì§€ì •í•œ ë³¼ë¥¨ ìƒì„±
docker volume create my-volume

# ì½˜í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê³  ì•„ê¹Œ ìƒì„±í•œ ë³¼ë¥¨ì„ ì½˜í…Œì´ë„ˆ íŒŒì¼ ì‹œìŠ¤í…œì— ë§ˆìš´íŠ¸
docker run  -it --rm --mount source=my-volume,destination=/my-data/ ubuntu:22.04

# ì˜ ëª…ë ¹ìœ¼ë¡œë„ ê°™ì€ ì‘ì—…ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ.
docker run  -it --rm -v my-volume:/my-data ubuntu:22.04

# ì´ì œ ë§ˆìš´íŠ¸í•œ ë³¼ë¥¨ì— íŒŒì¼ì„ ì €ì¥ í•  ìˆ˜ ìˆìŒ.
echo "Hello from the container!" > /my-data/hello.txt
cat my-data/hello.txt
exit
```
![](https://velog.velcdn.com/images/luckyprice1103/post/7a964715-2c4f-46ed-ba39-397e7ad6f48f/image.png)



```
# ì›ë˜ ì»¨í…Œì´ë„ˆë¥¼ ì§€ìš°ê°€ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ìƒì„±í•œí›„ ë‹¤ì‹œ mount
docker run  -it --rm --mount source=my-volume,destination=/my-data/ ubuntu:22.04
cat my-data/hello.txt # This time it succeeds!
exit
```
![](https://velog.velcdn.com/images/luckyprice1103/post/f4c2b87b-a25d-477a-bcd7-0c2730697452/image.png)
ì»¨í…Œì´ë„ˆë¥¼ ì§€ì› ë‹¤ê°€ ë‹¤ì‹œ ë§Œë“¤ì–´ì§€ë§Œ ì™¸ë¶€ì— ìˆëŠ” ë³¼ë¥¨ì´ ë§ˆìš´íŠ¸ ë˜ë‹ˆê¹Œ íŒŒì¼ì€ ê·¸ëŒ€ë¡œë‹¤!!!

ê·¸ë ‡ë‹¤ë©´ ëŒ€ì²´ ì´ ë°ì´í„°ì™€ ë³¼ë¥¨ì€ ì–´ë””ì— ìœ„ì¹˜ í•˜ê³  ìˆëŠ”ê±¸ê¹Œ?
ë¦¬ëˆ…ìŠ¤ ê°™ì€ ê²½ìš°, /var/lib/docker/volumesì— ìœ„ì¹˜í•˜ê³  ìˆì§€ë§Œ, ë‚˜ê°™ì€ ìœˆë„ìš°ë‚˜ ë§¥ì—ì„œ ë„ì»¤ ë°ìŠ¤í¬íƒ‘ì„ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì‚¬ëŒë“¤ì€ Dockerê°€ ë¦¬ëˆ…ìŠ¤ ê°€ìƒ ë¨¸ì‹ ì•ˆì—ì„œ ë§Œë“ ë‹¤.

VMì•ˆì—ì„œ íŒŒì¼ ì‹œìŠ¤í…œì„ ë³¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì¤‘ì—ì„œ í•˜ë‚˜ëŠ” ìš°ë¦¬ì—ê²Œ PID 1ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ì—ì„œ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ìˆ˜ ìˆë„ë¡ í—ˆë½í•´ì£¼ëŠ” [justincormat](https://hub.docker.com/r/justincormack/nsenter1)ì— ì˜í•´ ìƒì„±ë˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.

```
# ë„ì»¤ ë¦¬ëˆ…ìŠ¤ vmì— ì ‘ì†í•  ìˆ˜ ìˆëŠ” ì»¨í…Œì´ë„ˆ ìƒì„±
# Pinning to the image hash ensures it is this SPECIFIC image and not an updated one helps minimize the potential of a supply chain attack
docker run -it --rm --privileged --pid=host justincormack/nsenter1@sha256:5af0be5e42ebd55eea2c593e4622f810065c3f45bb805eaacf43f08f3d06ffd8

# ë‚´ ë³¼ë¥¨ì´ ì¡´ì¬í•˜ëŠ”ê³³ìœ¼ë¡œ:
ls /var/lib/docker/volumes/my-volume/_data
cat /var/lib/docker/volumes/my-volume/_data/hello.txt 
```

![](https://velog.velcdn.com/images/luckyprice1103/post/293a0124-d1b4-4b5f-93cf-9a25c800c20a/image.png)ë‚´ ë³¼ë¥¨ì´ ì˜ ì¡´ì¬í•˜ê³  ìˆë‹¤....!

ì´ëŸ¬í•œ ì ‘ê·¼ë°©ì‹ì€ í”„ë¡œê·¸ë¨ì´ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë ¤ê³  ì•Œë ¤ì§„ ê²½ë¡œì— ìœ„ì¹˜í•˜ê³  ìˆëŠ” ë³¼ë¥¨ì„ ë§ˆìš´íŠ¸ í•˜ëŠ”ë°ì— ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

```
#postgres ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¡œë¶€í„°  ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ê³ , pgdataë¼ê³  ì•Œë ¤ì§„ ë³¼ë¥¨ì„ ì•Œë ¤ì§„ ì €ì¥ ì¥ì†Œë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë§ˆìš´íŠ¸
docker run -it --rm -v pgdata:/var/lib/postgresql/data -e POSTGRES_PASSWORD=foobarbaz postgres:15.1-alpine
```

> - ë°”ì¸ë“œ ë§ˆìš´íŠ¸

```
# host filesystemì—ì„œ ì»¨í…Œì´ë„ˆë¡œ ë””ë ‰í† ë¦¬ë¥¼ ë§ˆìš´íŠ¸í•˜ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±
docker run  -it --rm --mount type=bind,source="${PWD}"/my-data,destination=/my-data ubuntu:22.04
# ìœ„ì˜ ì‘ì—…ê³¼ ê°™ì€ ëª…ë ¹ì„ í•´ì£¼ëŠ” ì½”ë“œ
docker run  -it --rm -v ${PWD}/my-data:/my-data ubuntu:22.04

echo "Hello from the container!" > /my-data/hello.txt

# ë‚´ host íŒŒì¼ ì‹œìŠ¤í…œì—ì„œë„ hello.txtë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŒ.
cat my-data/hello.txt
exit
```

ì €ì¥ë˜ëŠ” ë°ì´í„°ë¥¼ ì‰½ê²Œ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´ ë°”ì¸ë“œ ë§ˆìš´íŠ¸ê°€ ì¢‹ì„ ìˆ˜ ìˆì§€ë§Œ [ë§í¬](https://docs.docker.com/storage/volumes/)ì— ë³¼ë¥¨ì´ ì„ í˜¸ë˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ ì´ìœ ê°€ ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤(Windowsë‚˜ ë§¥ì—ì„œ Docker Desktopì„ ì‹¤í–‰í•˜ëŠ” ê²½ìš° ì†ë„ ë¬¸ì œ ë“±) 

> Using 3rd Party Containers


ì§€ê¸ˆê¹Œì§€ ë°ì´í„° ìŠ¤í† ë¦¬ì§€ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì•Œì•„ë´¤ë‹¤. ì´ì œ 3rd party ì»¨í…Œì´ê°€ êµ¬ë™ë˜ëŠ” ë‹¤ì–‘í•œ usecase ì˜ˆì‹œë¥¼ ì•Œì•„ë³´ì...!

databases, interactive test environments, and CLI utilities.

### 1. Databases

ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì„¤ì¹˜ì™€ ì„¤ì •ì´ ê³„ì† ë³€í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•…ëª…ì´ ë†’ë‹¤.
ë°ì´í„° ë² ì´ìŠ¤ë“¤ì˜ ì§€ì¹¨ì€ ë³µì¡í•˜ê³  ë²„ì „ê³¼ ìš´ì˜ì²´ì œ ë³„ë¡œ ìƒë‹¹íˆ ë‹¤ë¥´ë‹¤. 
ê°œë°œì„ ì§„í–‰í•  ê²½ìš° ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì—¬ëŸ¬ ë²„ì „ì„ ì‹¤í–‰í•´ì•¼ í•˜ê±°ë‚˜ ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œ ìƒˆë¡œìš´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•˜ëŠ”ê²ƒì´ í° ë„ì›€ì´ ë  ìˆ˜ ìˆë‹¤.

ì„¤ì •ê³¼ ì„¤ì¹˜ê°€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì—ì˜ìƒˆ ì¡°ì‘ë˜ë¯€ë¡œ, ë‚´ê°€ ì œê³µí•´ì•¼ í• ê²ƒì€ ê·¸ëƒ¥ ëª‡ê°€ì§€ì˜ ì„¤ì •ê°’ ë¿ì´ë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì˜ ë²„ì „ì„ ë°”ê¾¸ë ¤ë©´ ê·¸ëƒ¥ ì´ë¯¸ì§€ì˜ tagê°’ì„ ë°”ê¿”ì£¼ë©´ëœë‹¤.(e.g. postgres:14.6 vs postgres:15.1 ).

ì»¨í…Œì´ë„ˆì—ì„œ ë°ì´í„° ë² ì´ìŠ¤ë¥¼ êµ¬ë™í•˜ëŠ”ë°ì— ì¤‘ìš”í•œ ëª‡ê°€ì§€ ì‚¬í•­ë“¤ì´ìˆë‹¤.

- ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ê¸° ìœ„í•´ ë³¼ë¥¨ì‚¬ìš©
- ì¶”ê°€ì ì¸ ì„¤ì •ì„ ìœ„í•´ì„œ bind mount ì‚¬ìš©
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

&nbsp
Postgres
```
docker run -d --rm \
  -v pgdata:/var/lib/postgresql/data \
  -e POSTGRES_PASSWORD=foobarbaz \
  -p 5432:5432 \
  postgres:15.1-alpine

# With custom postresql.conf file
docker run -d --rm \
  -v pgdata:/var/lib/postgresql/data \
  -v ${PWD}/postgres.conf:/etc/postgresql/postgresql.conf \
  -e POSTGRES_PASSWORD=foobarbaz \
  -p 5432:5432 \
  postgres:15.1-alpine -c 'config_file=/etc/postgresql/postgresql.conf'
```
&nbsp
Mongo
```
docker run -d --rm \
  -v mongodata:/data/db \
  -e MONGO_INITDB_ROOT_USERNAME=root \
  -e MONGO_INITDB_ROOT_PASSWORD=foobarbaz \
  -p 27017:27017 \
  mongo:6.0.4

# With custom mongod.conf file
docker run -d --rm \
  -v mongodata:/data/db \
  -v ${PWD}/mongod.conf:/etc/mongod.conf \
  -e MONGO_INITDB_ROOT_USERNAME=root \
  -e MONGO_INITDB_ROOT_PASSWORD=foobarbaz \
  -p 27017:27017 \
  mongo:6.0.4 --config /etc/mongod.conf
```
&nbsp
Redis
```
docker run -d --rm \
  -v redisdata:/data \
  redis:7.0.8-alpine

# With custom redis.conf file
docker run -d --rm \
  -v redisdata:/data \
  -v ${PWD}/redis.conf:/usr/local/etc/redis/redis.conf \
  redis:7.0.8-alpine redis-server /usr/local/etc/redis/redis.conf
```
&nbsp
MySQL
```
docker run -d --rm \
  -v mysqldata:/var/lib/mysql \
  -e MYSQL_ROOT_PASSWORD=foobarbaz \
  mysql:8.0.32

# With custom conf.d
docker run -d --rm \
  -v mysqldata:/var/lib/mysql \
  -v ${PWD}/conf.d:/etc/mysql/conf.d \
  -e MYSQL_ROOT_PASSWORD=foobarbaz \
  mysql:8.0.32
```
&nbsp
Elasticsearch
```
docker run -d --rm \
  -v elasticsearchdata:/usr/share/elasticsearch/data
  -e ELASTIC_PASSWORD=foobarbaz \
  -e "discovery.type=single-node" \
  -p 9200:9200 \
  -p 9300:9300 \
  elasticsearch:8.6.0
```
&nbsp
Neo4j
```
docker run -d --rm \
    -v=neo4jdata:/data \
    -e NEO4J_AUTH=neo4j/foobarbaz \
    -p 7474:7474 \
    -p 7687:7687 \
    neo4j:5.4.0-community
```
&nbsp
### 2. Interactive Test Environments

&nbsp
Operating systems
```
# https://hub.docker.com/_/ubuntu
docker run -it --rm ubuntu:22.04

# https://hub.docker.com/_/debian
docker run -it --rm debian:bullseye-slim

# https://hub.docker.com/_/alpine
docker run -it --rm alpine:3.17.1

# https://hub.docker.com/_/busybox
docker run -it --rm busybox:1.36.0 # small image with lots of useful utilities
```
&nbsp
Programming runtimes
```
# https://hub.docker.com/_/python
docker run -it --rm python:3.11.1

# https://hub.docker.com/_/node
docker run -it --rm node:18.13.0

# https://hub.docker.com/_/php
docker run -it --rm php:8.1

# https://hub.docker.com/_/ruby
docker run -it --rm ruby:alpine3.17
```

&nbsp
### 3. CLI Utilities

ê°€ë” íŠ¹ì •í•œ ìœ í‹¸ë¦¬í‹°ê°€ í˜„ì¬ ë‚´ ì‹œìŠ¤í…œì— ì„¤ì¹˜ë˜ì–´ìˆì§€ ì•Šê±°ë‚˜, ë²„ì „ë³„ë¡œ í°ì°¨ì´ê°€ ìˆëŠ” ê²½ìš°, í˜¸ìŠ¤íŠ¸ì— ì•„ë¬´ê²ƒë„ ì„¤ì¹˜í•  í•„ìš” ì—†ì´ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ íŠ¹ì •í•œ ë²„ì „ì˜ ìœ í‹¸ë¦¬í‹°ë¥¼ êµ¬ë™ í•  ìˆ˜ ìˆë‹¤.

&nbsp
jq (json command line utility)
```
docker run -i stedolan/jq <sample-data/test.json '.key_1 + .key_2'
```
&nbsp
yq (yaml command line utility)
```
docker run -i mikefarah/yq <sample-data/test.yaml '.key_1 + .key_2'
```
&nbsp
sed
```
docker run -i --rm busybox:1.36.0 sed 's/file./file!/g' <sample-data/test.txt
```
&nbsp
base64
```
# Pipe input from previous command
echo "This string is just long enough to trigger a line break in GNU base64." | docker run -i --rm busybox:1.36.0 base64

# Read input from file
docker run -i --rm busybox:1.36.0 base64 </sample-data/test.txt
```
&nbsp
Amazon Web Services CLI
```
docker run --rm -v ~/.aws:/root/.aws amazon/aws-cli:2.9.18 s3 ls
```
&nbsp
Google Cloud Platform CLI
```
# Bind mount the credentials into the container
docker run --rm -v ~/.config/gcloud:/root/.config/gcloud gcr.io/google.com/cloudsdktool/google-cloud-cli:415.0.0 gsutil ls
# Why is the container image so big ğŸ˜­?! 2.8GB
```

&nbsp
### 3. Improving the Ergonomics

ë§Œì•½ ë„ˆê°€ ì´ëŸ¬í•œ ìœ í‹¸ë¦¬í‹°ë¥¼ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ ìì£¼ ì‚¬ìš©í•  ê³„íšì´ ìˆë‹¤ë©´ ì‰˜ ê¸°ëŠ¥ì´ë‚˜ aliaë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ì´ ë‚´ í˜¸ìŠ¤íŠ¸ ì•ˆì— ì„¤ì¹˜ë˜ì–´ìˆëŠ”ë“¯í•œ ëŠë‚Œì„ ì£¼ë„ë¡ ì„¤ê³„í•˜ëŠ”ê²ƒì´ íš¨ìœ¨ì ì´ë‹¤....!
Here are examples of this for yq:

```
# Shell function
yq-shell-function() {
  docker run --rm -i -v ${PWD}:/workdir mikefarah/yq "$@"
}
yq-shell-function <sample-data/test.yaml '.key_1 + .key_2'

---

# Alias
alias 'yq-alias=docker run --rm -i -v ${PWD}:/workdir mikefarah/yq'
yq-alias <sample-data/test.yaml '.key_1 + .key_2'
```


# ë„ì»¤ ì„œë“œíŒŒí‹° ì»¨í…Œì´ë„ˆ ì‚¬ìš©ë²•

## 1. ë„ì»¤ì˜ ì„¤ì¹˜ì™€ ì‹¤í–‰
  
  [ë„ì»¤ ì„¤ì¹˜ í•˜ê¸°](https://www.docker.com/)
  
  ì„¤ì¹˜ë¥¼ ì™„ë£Œí•˜ë©´ ì´ì œ ê°„ë‹¨í•œ ì»¨í…Œì´ë„ˆë¥¼ êµ¬ë™í•´ë³´ì.
  
  ```
docker run --env POSTGRES_PASSWORD=ansadmin --publish 5432:5432 postgres:15.7-alpine
```
![](https://velog.velcdn.com/images/luckyprice1103/post/d1c0ee29-d2d4-415c-bc10-48a26e237ca0/image.png)![](https://velog.velcdn.com/images/luckyprice1103/post/c6abf995-e33a-4aa2-b09c-0f26adcef7b2/image.png)
ì»¨í…Œì´ë„ˆ ì‘ë™ì´ ì˜ ëœë‹¤....!
![](https://velog.velcdn.com/images/luckyprice1103/post/cc201512-d8c5-45ea-8a13-4d4f5c16c6a6/image.png)pgAdmin4 ì„œë²„ connectionì—ì„œë„ ì—°ê²°ì´ ëœë‹¤...!

## 2. ì„œë“œíŒŒí‹° ì»¨í…Œì´ë„ˆ ì‚¬ìš©

![](https://velog.velcdn.com/images/luckyprice1103/post/6da25a1c-a227-4393-807b-46c57a991567/image.png)

> ë°ì´í„°ì˜ ì§€ì†ì„±

![](https://velog.velcdn.com/images/luckyprice1103/post/1a254cc4-c5e8-4179-8b28-14d68aee2cee/image.png)


ìš°ë¦¬ê°€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¡œ ë¶€í„° ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ë–„, ì´ë¯¸ì§€ì— ìˆëŠ” ëª¨ë“ ê²ƒì€ read-onlyë¡œ ì·¨ê¸‰ëœë‹¤. ê·¸ë¦¬ê³  ë§¨ìœ„ì— ìƒˆë¡œìš´ layerê°€ read/wirteë¡œ ì’¸ì›Œì§„ë‹¤.


> dependency ì„¤ì¹˜ ë°ì´í„° ë³´ì¡´


ì´ì œ ì»¨í…Œì´ë„ˆê°€ runtimeí• ë•Œ ë¬´ì–¸ê°€ë¥¼ ì„¤ì¹˜í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì‹¤ìŠµì„ í•´ë³´ì. ë¬¼ë¡  ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë ë•Œ contentë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒì€ ì£¼ëœ í–‰ë™ì€ ì•„ë‹ˆì§€ë§Œ í•™ìŠµ ëª©ì ìœ¼ë¡œ í•´ë³´ì


```
# ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ë¡œë¶€í„° ì»¨íƒœì´ë„ˆ ë§Œë“¤ê¸°
docker run --interactive --tty --rm ubuntu:22.04
```

-it (ë˜ëŠ” --interactiveì™€ --tty): ì»¨í…Œì´ë„ˆì™€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ëŒ€í™”í˜• ëª¨ë“œë¡œ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ í„°ë¯¸ë„ì— ì ‘ì†í• ìˆ˜ ìˆìŒ. ì´ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê³  í„°ë¯¸ë„ ì„¸ì…˜ì„ ìœ ì§€ê°€ëŠ¥í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

 --rm ì˜µì…˜ì€ ì»¨í…Œì´ë„ˆë¥¼ ì¼íšŒì„±ìœ¼ë¡œ ì‹¤í–‰í•  ë•Œ ì£¼ë¡œ ì“°ì´ëŠ”ë° ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ ì»¨í…Œì´ë„ˆì™€ ê´€ë ¨ëœ ë¦¬ì†ŒìŠ¤(íŒŒì¼ ì‹œìŠ¤í…œ, ë³¼ë¥¨)ê¹Œì§€ ê¹¨ë—ì´ ì œê±°í•´ì¤€ë‹¤.
 
 
 ```
# ping ì„¤ì¹˜
apt update
apt install iputils-ping --yes
```

 ```
 # google.comdì— ping ì‹œë„
ping google.com -c 1
```
![](https://velog.velcdn.com/images/luckyprice1103/post/8ed49fc5-f9c5-4d64-b523-84ad42f707bd/image.png)


ì´ì œ ë‹¤ì‹œ ì‹œë„ í•´ë³´ì.
```
docker run --interactive --tty --rm ubuntu:22.04
ping google.com -c 1
```

ìœ„ì— ì½”ë“œê°€ ë ì§€ ì•ˆë ì§€ ë°ì´í„°ì˜ ì§€ì†ì„±ì— ëŒ€í•´ ìƒê°í•˜ë©´ì„œ ì¶”ì¸¡í•´ë³´ì.
.
.
.
.
.
.
.
.
.
ë‹µì€ ë‹¹ì—°íˆ ì‹¤í–‰ì´ ì•ˆëœë‹¤. ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ëŠ” ìˆœê°„ ì›ë˜ ìˆëŠ” ë°ì´í„°ëŠ” ëª¨ì¡°ë¦¬ ë‚ ë¼ê°„ë‹¤. ê·¸ë ‡ë‹¤ë©´ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²° í•  ìˆ˜ ìˆì„ê¹Œ?


```
# ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ë¡œë¶€í„° ì»¨í…Œì´ë„ˆ ìƒì„± (--rm flag ì—†ì´)
docker run -it --name my-ubuntu-container ubuntu:22.04
```
í•‘ì„ ì„¤ì¹˜í•˜ê³  ë‹¤ì‹œ exit í•´ë³´ì
```
# Install & use ping
apt update
apt install iputils-ping --yes
ping google.com -c 1
exit
```

![](https://velog.velcdn.com/images/luckyprice1103/post/56480008-8eb1-434f-bed6-fa3b4fac0897/image.png)
docker ps -aë¥¼ í†µí•´í™•ì¸í•´ë³´ë‹ˆ ì»¨í…Œì´ë„ˆëŠ” stopped ë˜ê¸´ í–ˆì§€ë§Œ, ì•„ì§ read/write ì˜ì—­ì— ì¡´ì¬í•˜ê³  ìˆëŠ”ê²ƒìœ¼ ì•Œ ìˆ˜ ìˆë‹¤. ë‹¤ì‹œ ì»¨í…Œì´ë„ˆë¥¼ ì‹œì‘í•´ì„œ pingëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ë³´ì

```
# Restart the container and attach to running shell
docker start my-ubuntu-container
docker attach my-ubuntu-container
```

```
# Test ping
ping google.com -c 1 # ì„±ê³µ! ğŸ‰
exit
```

ê·¼ë° ì‚¬ì‹¤ ìš°ë¦¬ê°€ ì›í•˜ëŠ”ê±´ ì´ëŸ°ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì•„ì˜ˆ ì²˜ìŒë¶€í„° ì´ë¯¸ì§€ ìì²´ì— ë°ì´í„°ë“¤ì´ í¬í•¨ë˜ëŠ” ê²ƒì„ ì›í•œë‹¤. ì¦‰ ìš°ë¦¬ëŠ” dependencyê°€ í¬í•¨ëœ ìš°ë¦¬ë§Œì˜ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ì•¼í•œë‹¤.

```
# Build a container image with ubuntu image as base and ping installed
docker build --tag my-ubuntu-image -<<EOF
FROM ubuntu:22.04
RUN apt update && apt install iputils-ping --yes
EOF

# Run a container based on that image
docker run -it --rm my-ubuntu-image

# Confirm that ping was pre-installed
ping google.com -c 1 # Success! ğŸ¥³
```

> ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìƒì„±ëœ ì§€ì† ë°ì´í„°

![](https://velog.velcdn.com/images/luckyprice1103/post/73cd7d62-88e2-4e91-825a-b1a7c562fafc/image.png)

ì´ë²ˆì—ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í•´ ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ëŠ” ì‹¤ìŠµì„ í•´ë³´ì.

```
# ì½˜í…Œì´ë„ˆ ìƒì„±
docker run -it --rm ubuntu:22.04

# ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“œê³  íŒŒì¼ì„ ê·¸ ì•ˆì— ì €ì¥
mkdir my-data
echo "Hello from the container!" > /my-data/hello.txt

# íŒŒì¼ í™•ì¸
cat my-data/hello.txt
exit
```
![](https://velog.velcdn.com/images/luckyprice1103/post/319f3ecf-3cb6-4e51-9d37-8c05d44e5b91/image.png)


```
# ìš°ë¶„íˆ¬ ì´ë¯¸ì§€ë¡œ ë¶€í„° ì½˜í…Œì´ë„ˆ ìƒì„±
docker run -it --rm ubuntu:22.04

# íŒŒì¼ì´ ì•„ì§ ë‚¨ì•„ìˆëŠ”ì§€ í™•ì¸
cat my-data/hello.txt # Produces error: `cat: my-data/hello.txt: No such file or directory`
```

![](https://velog.velcdn.com/images/luckyprice1103/post/46a3b150-65ac-4bbb-984e-8f84a1c77f4c/image.png)

ì§ì‘í–ˆë“¯ì´, ìƒˆ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“œëŠ” ìˆœê°„ ë°ì´í„°ê°€ ì‹¹ ë‚ ì•„ê°„ë‹¤
ì´ë¥¼ ë°©ì§€ í•˜ê¸° ìœ„í•´ì„œ volumeì„ ì´ìš©í•´ë³´ì.

> - ë³¼ë¥¨ ë§ˆìš´íŠ¸

```
# ì´ë¦„ì„ ì§€ì •í•œ ë³¼ë¥¨ ìƒì„±
docker volume create my-volume

# ì½˜í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ê³  ì•„ê¹Œ ìƒì„±í•œ ë³¼ë¥¨ì„ ì½˜í…Œì´ë„ˆ íŒŒì¼ ì‹œìŠ¤í…œì— ë§ˆìš´íŠ¸
docker run  -it --rm --mount source=my-volume,destination=/my-data/ ubuntu:22.04

# ì˜ ëª…ë ¹ìœ¼ë¡œë„ ê°™ì€ ì‘ì—…ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ.
docker run  -it --rm -v my-volume:/my-data ubuntu:22.04

# ì´ì œ ë§ˆìš´íŠ¸í•œ ë³¼ë¥¨ì— íŒŒì¼ì„ ì €ì¥ í•  ìˆ˜ ìˆìŒ.
echo "Hello from the container!" > /my-data/hello.txt
cat my-data/hello.txt
exit
```
![](https://velog.velcdn.com/images/luckyprice1103/post/7a964715-2c4f-46ed-ba39-397e7ad6f48f/image.png)



```
# ì›ë˜ ì»¨í…Œì´ë„ˆë¥¼ ì§€ìš°ê°€ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ìƒì„±í•œí›„ ë‹¤ì‹œ mount
docker run  -it --rm --mount source=my-volume,destination=/my-data/ ubuntu:22.04
cat my-data/hello.txt # This time it succeeds!
exit
```
![](https://velog.velcdn.com/images/luckyprice1103/post/f4c2b87b-a25d-477a-bcd7-0c2730697452/image.png)
ì»¨í…Œì´ë„ˆë¥¼ ì§€ì› ë‹¤ê°€ ë‹¤ì‹œ ë§Œë“¤ì–´ì§€ë§Œ ì™¸ë¶€ì— ìˆëŠ” ë³¼ë¥¨ì´ ë§ˆìš´íŠ¸ ë˜ë‹ˆê¹Œ íŒŒì¼ì€ ê·¸ëŒ€ë¡œë‹¤!!!

ê·¸ë ‡ë‹¤ë©´ ëŒ€ì²´ ì´ ë°ì´í„°ì™€ ë³¼ë¥¨ì€ ì–´ë””ì— ìœ„ì¹˜ í•˜ê³  ìˆëŠ”ê±¸ê¹Œ?
ë¦¬ëˆ…ìŠ¤ ê°™ì€ ê²½ìš°, /var/lib/docker/volumesì— ìœ„ì¹˜í•˜ê³  ìˆì§€ë§Œ, ë‚˜ê°™ì€ ìœˆë„ìš°ë‚˜ ë§¥ì—ì„œ ë„ì»¤ ë°ìŠ¤í¬íƒ‘ì„ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì‚¬ëŒë“¤ì€ Dockerê°€ ë¦¬ëˆ…ìŠ¤ ê°€ìƒ ë¨¸ì‹ ì•ˆì—ì„œ ë§Œë“ ë‹¤.

VMì•ˆì—ì„œ íŒŒì¼ ì‹œìŠ¤í…œì„ ë³¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì¤‘ì—ì„œ í•˜ë‚˜ëŠ” ìš°ë¦¬ì—ê²Œ PID 1ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ì—ì„œ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ìˆ˜ ìˆë„ë¡ í—ˆë½í•´ì£¼ëŠ” [justincormat](https://hub.docker.com/r/justincormack/nsenter1)ì— ì˜í•´ ìƒì„±ë˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.

```
# ë„ì»¤ ë¦¬ëˆ…ìŠ¤ vmì— ì ‘ì†í•  ìˆ˜ ìˆëŠ” ì»¨í…Œì´ë„ˆ ìƒì„±
# Pinning to the image hash ensures it is this SPECIFIC image and not an updated one helps minimize the potential of a supply chain attack
docker run -it --rm --privileged --pid=host justincormack/nsenter1@sha256:5af0be5e42ebd55eea2c593e4622f810065c3f45bb805eaacf43f08f3d06ffd8

# ë‚´ ë³¼ë¥¨ì´ ì¡´ì¬í•˜ëŠ”ê³³ìœ¼ë¡œ:
ls /var/lib/docker/volumes/my-volume/_data
cat /var/lib/docker/volumes/my-volume/_data/hello.txt 
```

![](https://velog.velcdn.com/images/luckyprice1103/post/293a0124-d1b4-4b5f-93cf-9a25c800c20a/image.png)ë‚´ ë³¼ë¥¨ì´ ì˜ ì¡´ì¬í•˜ê³  ìˆë‹¤....!

ì´ëŸ¬í•œ ì ‘ê·¼ë°©ì‹ì€ í”„ë¡œê·¸ë¨ì´ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë ¤ê³  ì•Œë ¤ì§„ ê²½ë¡œì— ìœ„ì¹˜í•˜ê³  ìˆëŠ” ë³¼ë¥¨ì„ ë§ˆìš´íŠ¸ í•˜ëŠ”ë°ì— ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

```
#postgres ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¡œë¶€í„°  ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ê³ , pgdataë¼ê³  ì•Œë ¤ì§„ ë³¼ë¥¨ì„ ì•Œë ¤ì§„ ì €ì¥ ì¥ì†Œë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë§ˆìš´íŠ¸
docker run -it --rm -v pgdata:/var/lib/postgresql/data -e POSTGRES_PASSWORD=foobarbaz postgres:15.1-alpine
```

> - ë°”ì¸ë“œ ë§ˆìš´íŠ¸

```
# host filesystemì—ì„œ ì»¨í…Œì´ë„ˆë¡œ ë””ë ‰í† ë¦¬ë¥¼ ë§ˆìš´íŠ¸í•˜ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±
docker run  -it --rm --mount type=bind,source="${PWD}"/my-data,destination=/my-data ubuntu:22.04
# ìœ„ì˜ ì‘ì—…ê³¼ ê°™ì€ ëª…ë ¹ì„ í•´ì£¼ëŠ” ì½”ë“œ
docker run  -it --rm -v ${PWD}/my-data:/my-data ubuntu:22.04

echo "Hello from the container!" > /my-data/hello.txt

# ë‚´ host íŒŒì¼ ì‹œìŠ¤í…œì—ì„œë„ hello.txtë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŒ.
cat my-data/hello.txt
exit
```

ì €ì¥ë˜ëŠ” ë°ì´í„°ë¥¼ ì‰½ê²Œ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´ ë°”ì¸ë“œ ë§ˆìš´íŠ¸ê°€ ì¢‹ì„ ìˆ˜ ìˆì§€ë§Œ [ë§í¬](https://docs.docker.com/storage/volumes/)ì— ë³¼ë¥¨ì´ ì„ í˜¸ë˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ ì´ìœ ê°€ ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤(Windowsë‚˜ ë§¥ì—ì„œ Docker Desktopì„ ì‹¤í–‰í•˜ëŠ” ê²½ìš° ì†ë„ ë¬¸ì œ ë“±) 

> Using 3rd Party Containers


ì§€ê¸ˆê¹Œì§€ ë°ì´í„° ìŠ¤í† ë¦¬ì§€ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì•Œì•„ë´¤ë‹¤. ì´ì œ 3rd party ì»¨í…Œì´ê°€ êµ¬ë™ë˜ëŠ” ë‹¤ì–‘í•œ usecase ì˜ˆì‹œë¥¼ ì•Œì•„ë³´ì...!

databases, interactive test environments, and CLI utilities.

### 1. Databases

ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì„¤ì¹˜ì™€ ì„¤ì •ì´ ê³„ì† ë³€í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•…ëª…ì´ ë†’ë‹¤.
ë°ì´í„° ë² ì´ìŠ¤ë“¤ì˜ ì§€ì¹¨ì€ ë³µì¡í•˜ê³  ë²„ì „ê³¼ ìš´ì˜ì²´ì œ ë³„ë¡œ ìƒë‹¹íˆ ë‹¤ë¥´ë‹¤. 
ê°œë°œì„ ì§„í–‰í•  ê²½ìš° ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì—¬ëŸ¬ ë²„ì „ì„ ì‹¤í–‰í•´ì•¼ í•˜ê±°ë‚˜ ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œ ìƒˆë¡œìš´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•˜ëŠ”ê²ƒì´ í° ë„ì›€ì´ ë  ìˆ˜ ìˆë‹¤.

ì„¤ì •ê³¼ ì„¤ì¹˜ê°€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì—ì˜ìƒˆ ì¡°ì‘ë˜ë¯€ë¡œ, ë‚´ê°€ ì œê³µí•´ì•¼ í• ê²ƒì€ ê·¸ëƒ¥ ëª‡ê°€ì§€ì˜ ì„¤ì •ê°’ ë¿ì´ë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì˜ ë²„ì „ì„ ë°”ê¾¸ë ¤ë©´ ê·¸ëƒ¥ ì´ë¯¸ì§€ì˜ tagê°’ì„ ë°”ê¿”ì£¼ë©´ëœë‹¤.(e.g. postgres:14.6 vs postgres:15.1 ).

ì»¨í…Œì´ë„ˆì—ì„œ ë°ì´í„° ë² ì´ìŠ¤ë¥¼ êµ¬ë™í•˜ëŠ”ë°ì— ì¤‘ìš”í•œ ëª‡ê°€ì§€ ì‚¬í•­ë“¤ì´ìˆë‹¤.

- ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ê¸° ìœ„í•´ ë³¼ë¥¨ì‚¬ìš©
- ì¶”ê°€ì ì¸ ì„¤ì •ì„ ìœ„í•´ì„œ bind mount ì‚¬ìš©
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

&nbsp
Postgres
```
docker run -d --rm \
  -v pgdata:/var/lib/postgresql/data \
  -e POSTGRES_PASSWORD=foobarbaz \
  -p 5432:5432 \
  postgres:15.1-alpine

# With custom postresql.conf file
docker run -d --rm \
  -v pgdata:/var/lib/postgresql/data \
  -v ${PWD}/postgres.conf:/etc/postgresql/postgresql.conf \
  -e POSTGRES_PASSWORD=foobarbaz \
  -p 5432:5432 \
  postgres:15.1-alpine -c 'config_file=/etc/postgresql/postgresql.conf'
```
&nbsp
Mongo
```
docker run -d --rm \
  -v mongodata:/data/db \
  -e MONGO_INITDB_ROOT_USERNAME=root \
  -e MONGO_INITDB_ROOT_PASSWORD=foobarbaz \
  -p 27017:27017 \
  mongo:6.0.4

# With custom mongod.conf file
docker run -d --rm \
  -v mongodata:/data/db \
  -v ${PWD}/mongod.conf:/etc/mongod.conf \
  -e MONGO_INITDB_ROOT_USERNAME=root \
  -e MONGO_INITDB_ROOT_PASSWORD=foobarbaz \
  -p 27017:27017 \
  mongo:6.0.4 --config /etc/mongod.conf
```
&nbsp
Redis
```
docker run -d --rm \
  -v redisdata:/data \
  redis:7.0.8-alpine

# With custom redis.conf file
docker run -d --rm \
  -v redisdata:/data \
  -v ${PWD}/redis.conf:/usr/local/etc/redis/redis.conf \
  redis:7.0.8-alpine redis-server /usr/local/etc/redis/redis.conf
```
&nbsp
MySQL
```
docker run -d --rm \
  -v mysqldata:/var/lib/mysql \
  -e MYSQL_ROOT_PASSWORD=foobarbaz \
  mysql:8.0.32

# With custom conf.d
docker run -d --rm \
  -v mysqldata:/var/lib/mysql \
  -v ${PWD}/conf.d:/etc/mysql/conf.d \
  -e MYSQL_ROOT_PASSWORD=foobarbaz \
  mysql:8.0.32
```
&nbsp
Elasticsearch
```
docker run -d --rm \
  -v elasticsearchdata:/usr/share/elasticsearch/data
  -e ELASTIC_PASSWORD=foobarbaz \
  -e "discovery.type=single-node" \
  -p 9200:9200 \
  -p 9300:9300 \
  elasticsearch:8.6.0
```
&nbsp
Neo4j
```
docker run -d --rm \
    -v=neo4jdata:/data \
    -e NEO4J_AUTH=neo4j/foobarbaz \
    -p 7474:7474 \
    -p 7687:7687 \
    neo4j:5.4.0-community
```
&nbsp
### 2. Interactive Test Environments

&nbsp
Operating systems
```
# https://hub.docker.com/_/ubuntu
docker run -it --rm ubuntu:22.04

# https://hub.docker.com/_/debian
docker run -it --rm debian:bullseye-slim

# https://hub.docker.com/_/alpine
docker run -it --rm alpine:3.17.1

# https://hub.docker.com/_/busybox
docker run -it --rm busybox:1.36.0 # small image with lots of useful utilities
```
&nbsp
Programming runtimes
```
# https://hub.docker.com/_/python
docker run -it --rm python:3.11.1

# https://hub.docker.com/_/node
docker run -it --rm node:18.13.0

# https://hub.docker.com/_/php
docker run -it --rm php:8.1

# https://hub.docker.com/_/ruby
docker run -it --rm ruby:alpine3.17
```

&nbsp
### 3. CLI Utilities

ê°€ë” íŠ¹ì •í•œ ìœ í‹¸ë¦¬í‹°ê°€ í˜„ì¬ ë‚´ ì‹œìŠ¤í…œì— ì„¤ì¹˜ë˜ì–´ìˆì§€ ì•Šê±°ë‚˜, ë²„ì „ë³„ë¡œ í°ì°¨ì´ê°€ ìˆëŠ” ê²½ìš°, í˜¸ìŠ¤íŠ¸ì— ì•„ë¬´ê²ƒë„ ì„¤ì¹˜í•  í•„ìš” ì—†ì´ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ íŠ¹ì •í•œ ë²„ì „ì˜ ìœ í‹¸ë¦¬í‹°ë¥¼ êµ¬ë™ í•  ìˆ˜ ìˆë‹¤.

&nbsp
jq (json command line utility)
```
docker run -i stedolan/jq <sample-data/test.json '.key_1 + .key_2'
```
&nbsp
yq (yaml command line utility)
```
docker run -i mikefarah/yq <sample-data/test.yaml '.key_1 + .key_2'
```
&nbsp
sed
```
docker run -i --rm busybox:1.36.0 sed 's/file./file!/g' <sample-data/test.txt
```
&nbsp
base64
```
# Pipe input from previous command
echo "This string is just long enough to trigger a line break in GNU base64." | docker run -i --rm busybox:1.36.0 base64

# Read input from file
docker run -i --rm busybox:1.36.0 base64 </sample-data/test.txt
```
&nbsp
Amazon Web Services CLI
```
docker run --rm -v ~/.aws:/root/.aws amazon/aws-cli:2.9.18 s3 ls
```
&nbsp
Google Cloud Platform CLI
```
# Bind mount the credentials into the container
docker run --rm -v ~/.config/gcloud:/root/.config/gcloud gcr.io/google.com/cloudsdktool/google-cloud-cli:415.0.0 gsutil ls
# Why is the container image so big ğŸ˜­?! 2.8GB
```

&nbsp
### 3. Improving the Ergonomics

ë§Œì•½ ë„ˆê°€ ì´ëŸ¬í•œ ìœ í‹¸ë¦¬í‹°ë¥¼ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ ìì£¼ ì‚¬ìš©í•  ê³„íšì´ ìˆë‹¤ë©´ ì‰˜ ê¸°ëŠ¥ì´ë‚˜ aliaë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ì´ ë‚´ í˜¸ìŠ¤íŠ¸ ì•ˆì— ì„¤ì¹˜ë˜ì–´ìˆëŠ”ë“¯í•œ ëŠë‚Œì„ ì£¼ë„ë¡ ì„¤ê³„í•˜ëŠ”ê²ƒì´ íš¨ìœ¨ì ì´ë‹¤....!
Here are examples of this for yq:

```
# Shell function
yq-shell-function() {
  docker run --rm -i -v ${PWD}:/workdir mikefarah/yq "$@"
}
yq-shell-function <sample-data/test.yaml '.key_1 + .key_2'

---

# Alias
alias 'yq-alias=docker run --rm -i -v ${PWD}:/workdir mikefarah/yq'
yq-alias <sample-data/test.yaml '.key_1 + .key_2'
```
